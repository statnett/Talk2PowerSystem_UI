{{- $backend := required "The backend URL is required!" .Values.configuration.backend.url -}}
{{- $backendUrl := urlParse $backend -}}
server {
  listen 8080;
  server_name localhost {{ $backendUrl.hostname }};

  # Proxies the request for the Chatbot service to the correct address.
  location /rest/ {
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    set $upstream {{ printf "%s/rest/" $backend }};
    proxy_pass $upstream;
  }
}
